
name: Main Branch Workflow

on:
  push:
    branches:
      - main
    paths:
      - '.env'
      - 'settings/**'
permissions:
  id-token: write
  contents: write

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2

      - name: configure aws credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: arn:aws:iam::489994096722:role/oidc_assume_role-dev
          role-session-name: infraworkersession
          aws-region: us-west-2    

      # Add your additional setup steps here, e.g., installing dependencies, building, testing, etc.

      - name: Run Workflow on Changes
        run: |
          # Check if .env or anything in the settings/ directory has changed
          if git diff --name-only ${{ github.event.before }} ${{ github.sha }} | grep -E '(\.env|settings/)'; then
            # Your workflow steps go here
            echo "Changes detected in .env or settings/ directory. Running workflow..."
            # Add your commands or scripts to be executed when changes are detected.
          else
            echo "No relevant changes detected. Skipping workflow execution."
          fi
